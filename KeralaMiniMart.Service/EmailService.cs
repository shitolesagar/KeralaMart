using KeralaMiniMart.Abstraction;
using KeralaMiniMart.Abstraction.Repositories;
using KeralaMiniMart.Entities.Constant;
using KeralaMiniMart.Entities.WebViewModels;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net.Mail;
using System.Text;
using System.Threading.Tasks;

namespace KeralaMiniMart.Service
{
    public interface IEmailService
    {
        Task SendEmail(string to, string body, string subject, bool doAddAdminToCC = false);
        string ChangePasswordTemplateBody(string ResetPasswordLink = "#");
        string InvitationTemplateBody(string InvitationLink = "#", string invitedBy = "Plugable team");
        string SubscriptionTemplateBody(string PackageName = "Pacakge 1", string Amount = "40");
        string VerifyEmailTemplateBody(string EmailVerificationLink = "#");
        string OrderReciptTemplateBody(MailReciptViewModel model);
    }

    public class EmailService : IEmailService
    {
        private readonly IUnitOfWork unitOfWork;
        private readonly ISmtpMailRepository smtpMailRepository;

        public EmailService(IUnitOfWork unitOfWork, ISmtpMailRepository smtpMailRepository)
        {
            this.unitOfWork = unitOfWork;
            this.smtpMailRepository = smtpMailRepository;
        }

        public Task SendEmail(string to, string body, string subject, bool doAddAdminToCC = false)
        {
            var smtpInfo = smtpMailRepository.GetAll().FirstOrDefault();
            MailMessage mail = new MailMessage();
            SmtpClient SmtpServer = new SmtpClient(smtpInfo.Host);
            mail.From = new MailAddress(smtpInfo.FromMail, smtpInfo.DisplayName);
            if (doAddAdminToCC)
            {
                mail.CC.Add(EnvironmentConstants.AdminMail);
            }
            mail.To.Add(to);
            mail.Subject = subject;
            mail.Body = body;
            mail.IsBodyHtml = true;
            SmtpServer.Port = smtpInfo.Port;
            SmtpServer.Credentials = new System.Net.NetworkCredential(smtpInfo.FromMail, smtpInfo.SmtpPassword);
            SmtpServer.EnableSsl = true;
            return SmtpServer.SendMailAsync(mail);
        }

        public string ChangePasswordTemplateBody(string resetPasswordLink = "#")
        {
            string LogoImageUrl = "http://114.143.198.154:8386/images/asset/logo.png";
            string ResetPasswordLink = resetPasswordLink;
            return "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional //EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"> <html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\"> <head> <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"> <meta name=\"viewport\" content=\"width=device-width\"> <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"> <link href=\"https://fonts.googleapis.com/css?family=Poppins:100,200,300,400,500,600,700,800\" rel=\"stylesheet\"> <title></title> <style type=\"text/css\" id=\"media-query\"> *{ margin:0; padding:0; } body { margin: 0; padding: 0;  background: #f6f7fb !important; font-family: 'Poppins', sans-serif; font-weight: 500; line-height: 1.6; color:#2f2f2f; } .font-semi-bold{     font-weight: 600; } table, tr, td { vertical-align: top; border-collapse: collapse; } .ie-browser table, .mso-container table { table-layout: fixed; } * { line-height: inherit; } a[x-apple-data-detectors=true] { color: inherit !important; text-decoration: none !important; } [owa] .img-container div, [owa] .img-container button { display: block !important; } [owa] .fullwidth button { width: 100% !important; } [owa] .block-grid .col { display: table-cell; float: none !important; vertical-align: top; } .ie-browser .num12, .ie-browser .block-grid, [owa] .num12, [owa] .block-grid { width: 500px !important; } .ExternalClass, .ExternalClass p, .ExternalClass span, .ExternalClass font, .ExternalClass td, .ExternalClass div { line-height: 100%; } .ie-browser .mixed-two-up .num4, [owa] .mixed-two-up .num4 { width: 164px !important; } .ie-browser .mixed-two-up .num8, [owa] .mixed-two-up .num8 { width: 328px !important; } .ie-browser .block-grid.two-up .col, [owa] .block-grid.two-up .col { width: 250px !important; } .ie-browser .block-grid.three-up .col, [owa] .block-grid.three-up .col { width: 166px !important; } .ie-browser .block-grid.four-up .col, [owa] .block-grid.four-up .col { width: 125px !important; } .ie-browser .block-grid.five-up .col, [owa] .block-grid.five-up .col { width: 100px !important; } .ie-browser .block-grid.six-up .col, [owa] .block-grid.six-up .col { width: 83px !important; } .ie-browser .block-grid.seven-up .col, [owa] .block-grid.seven-up .col { width: 71px !important; } .ie-browser .block-grid.eight-up .col, [owa] .block-grid.eight-up .col { width: 62px !important; } .ie-browser .block-grid.nine-up .col, [owa] .block-grid.nine-up .col { width: 55px !important; } .ie-browser .block-grid.ten-up .col, [owa] .block-grid.ten-up .col { width: 50px !important; } .ie-browser .block-grid.eleven-up .col, [owa] .block-grid.eleven-up .col { width: 45px !important; } .ie-browser .block-grid.twelve-up .col, [owa] .block-grid.twelve-up .col { width: 41px !important; } @media only screen and (min-width: 520px) { .block-grid { width: 500px !important; } .block-grid .col { vertical-align: top; } .block-grid .col.num12 { width: 500px !important; } .block-grid.mixed-two-up .col.num4 { width: 164px !important; } .block-grid.mixed-two-up .col.num8 { width: 328px !important; } .block-grid.two-up .col { width: 250px !important; } .block-grid.three-up .col { width: 166px !important; } .block-grid.four-up .col { width: 125px !important; } .block-grid.five-up .col { width: 100px !important; } .block-grid.six-up .col { width: 83px !important; } .block-grid.seven-up .col { width: 71px !important; } .block-grid.eight-up .col { width: 62px !important; } .block-grid.nine-up .col { width: 55px !important; } .block-grid.ten-up .col { width: 50px !important; } .block-grid.eleven-up .col { width: 45px !important; } .block-grid.twelve-up .col { width: 41px !important; } } @media (max-width: 520px) { .block-grid, .col { min-width: 320px !important; max-width: 100% !important; display: block !important; } .block-grid { width: calc(100% - 40px) !important; } .col { width: 100% !important; } .col > div { margin: 0 auto; } img.fullwidth, img.fullwidthOnMobile { max-width: 100% !important; } .no-stack .col { min-width: 0 !important; display: table-cell !important; } .no-stack.two-up .col { width: 50% !important; } .no-stack.mixed-two-up .col.num4 { width: 33% !important; } .no-stack.mixed-two-up .col.num8 { width: 66% !important; } .no-stack.three-up .col.num4 { width: 33% !important; } .no-stack.four-up .col.num3 { width: 25% !important; } } </style> </head> <body class=\"clean-body\" style=\"margin: 0;padding: 0;-webkit-text-size-adjust: 100%;background-color: #f6f7fb;\"> <table class=\"nl-container\" style=\"border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;min-width: 320px;Margin: 0 auto;background-color: #ffffff;\" cellpadding=\"0\" cellspacing=\"0\"> <tbody>  <tr style=\"vertical-align: top\">     <td style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">               <!-- logo section   -->        <div style=\"background-color:transparent;\">           <div style=\"Margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\" class=\"block-grid \">              <div style=\"border-collapse: collapse;display: table;width: 100%;background-color:transparent;\">                 <div class=\"col num12\" style=\"min-width: 320px;max-width: 500px;display: table-cell;vertical-align: top;background:#f6f7fb;\">                    <div style=\"background-color: transparent; width: 100% !important;\">                       <div style=\"border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;\">                          <div class=\"img-container center  autowidth \" style=\"text-align:center;padding:15px;\">                             <img class=\"center  autowidth \" align=\"center\" border=\"0\" src=\"" + LogoImageUrl + "\" alt=\"Image\" title=\"Image\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: 0;height: auto;float: none;width: 100%;max-width: 161px;margin:0 auto;\" width=\"161\">                          </div>                       </div>                    </div>                 </div>              </div>           </div>        </div>        <!-- logo section end  -->  <!-- content section -->        <div style=\"background-color:transparent;border-top: 5px solid #5a00af;border-bottom: 10px solid #f5f5f5;\">           <div style=\"background-color:transparent;\">              <div style=\"Margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\" class=\"block-grid \">                 <div style=\"border-collapse: collapse;display: table;width: 100%;background-color:transparent;\">                    <div class=\"col num12\" style=\"min-width: 320px;max-width: 500px;display: table-cell;vertical-align: top;\">                       <div style=\"background-color: transparent; width: 100% !important;\">                          <div style=\"padding:0 10px;border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-top:20px; padding-bottom:30px; padding-right: 0px; padding-left: 0px;\">                             <div style=\" padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;\">                                <div style=\"font-size:12px;padding:0 25px;text-align:left;\">                                   <p style=\"margin: 0;font-size: 12px;color:#000;\"><span class=\"font-semi-bold\" style=\"font-size: 16px;\">Changing your plug-able password</span>                                   <p style=\"font-size:14px;padding:10px 0;\">Need to reset your password? No Problem. Just click below to get started.</p>                                   <div style=\"text-align:center;\">                                      <a href=\"#\" style=\"margin:20px 0;background:#5a00af;color:#fff;                                         font-size:14px;border:0;border-radius:4px;min-width:120px;padding:10px 15px;text-decoration:none;display:inline-block;\">Reset my password</a>                                   </div>                                   <p style=\"font-size:14px;padding-bottom:15px;margin-top:20px;\">If you didn't request to change your plug-able password, you don't have to do anything. So that's easy.</p>                                                                      <p style=\"font-size:14px;margin-top:30px;\">Thank you,</p>                                   <p style=\"font-size:14px;\">Plug-able team</p>                                   </p>                                </div>                             </div>                          </div>                       </div>                    </div>                 </div>              </div>           </div>        </div>        <!-- content section end-->  <!-- footer content section -->        <div style=\"background-color:transparent;\">           <div style=\"Margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\" class=\"block-grid \">              <div style=\"border-collapse: collapse;display: table;width: 100%;background-color:transparent;\">                 <div class=\"col num12\" style=\"min-width: 320px;max-width: 500px;display: table-cell;vertical-align: top;background:#262f36;\">                    <div style=\"background-color: transparent; width: 100% !important;\">                       <div style=\"border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;\">                          <div style=\"padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;\">                             <div style=\"font-size:12px;text-align:center;\">                             </div>                             <div style=\"font-size:12px;text-align:center;color:#fff;\">                                <p style=\"margin: 0;font-size: 12px;text-align: center\"><span style=\"font-size: 14px;font-weight:300;\">\u00A9 2018, plug-able.com</span></p>                             </div>                          </div>                       </div>                    </div>                 </div>              </div>           </div>        </div>        <!-- footer content section -->             </td>  </tr> </tbody> </table> </body> </html>";
        }

        public string InvitationTemplateBody(string InvitationLink = "#", string invitedBy = "Plugable team")
        {
            string LogoImageUrl = "http://114.143.198.154:8386/images/asset/logo.png";
            return "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional //EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"> <html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\"> <head> <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"> <meta name=\"viewport\" content=\"width=device-width\"> <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"> <link href=\"https://fonts.googleapis.com/css?family=Poppins:100,200,300,400,500,600,700,800\" rel=\"stylesheet\"> <title></title> <style type=\"text/css\" id=\"media-query\"> *{ margin:0; padding:0; } body { margin: 0; padding: 0;  background: #f6f7fb !important; font-family: 'Poppins', sans-serif; font-weight: 500; line-height: 1.6; color:#2f2f2f; } .font-semi-bold{     font-weight: 600; } table, tr, td { vertical-align: top; border-collapse: collapse; } .ie-browser table, .mso-container table { table-layout: fixed; } * { line-height: inherit; } a[x-apple-data-detectors=true] { color: inherit !important; text-decoration: none !important; } [owa] .img-container div, [owa] .img-container button { display: block !important; } [owa] .fullwidth button { width: 100% !important; } [owa] .block-grid .col { display: table-cell; float: none !important; vertical-align: top; } .ie-browser .num12, .ie-browser .block-grid, [owa] .num12, [owa] .block-grid { width: 500px !important; } .ExternalClass, .ExternalClass p, .ExternalClass span, .ExternalClass font, .ExternalClass td, .ExternalClass div { line-height: 100%; } .ie-browser .mixed-two-up .num4, [owa] .mixed-two-up .num4 { width: 164px !important; } .ie-browser .mixed-two-up .num8, [owa] .mixed-two-up .num8 { width: 328px !important; } .ie-browser .block-grid.two-up .col, [owa] .block-grid.two-up .col { width: 250px !important; } .ie-browser .block-grid.three-up .col, [owa] .block-grid.three-up .col { width: 166px !important; } .ie-browser .block-grid.four-up .col, [owa] .block-grid.four-up .col { width: 125px !important; } .ie-browser .block-grid.five-up .col, [owa] .block-grid.five-up .col { width: 100px !important; } .ie-browser .block-grid.six-up .col, [owa] .block-grid.six-up .col { width: 83px !important; } .ie-browser .block-grid.seven-up .col, [owa] .block-grid.seven-up .col { width: 71px !important; } .ie-browser .block-grid.eight-up .col, [owa] .block-grid.eight-up .col { width: 62px !important; } .ie-browser .block-grid.nine-up .col, [owa] .block-grid.nine-up .col { width: 55px !important; } .ie-browser .block-grid.ten-up .col, [owa] .block-grid.ten-up .col { width: 50px !important; } .ie-browser .block-grid.eleven-up .col, [owa] .block-grid.eleven-up .col { width: 45px !important; } .ie-browser .block-grid.twelve-up .col, [owa] .block-grid.twelve-up .col { width: 41px !important; } @media only screen and (min-width: 520px) { .block-grid { width: 500px !important; } .block-grid .col { vertical-align: top; } .block-grid .col.num12 { width: 500px !important; } .block-grid.mixed-two-up .col.num4 { width: 164px !important; } .block-grid.mixed-two-up .col.num8 { width: 328px !important; } .block-grid.two-up .col { width: 250px !important; } .block-grid.three-up .col { width: 166px !important; } .block-grid.four-up .col { width: 125px !important; } .block-grid.five-up .col { width: 100px !important; } .block-grid.six-up .col { width: 83px !important; } .block-grid.seven-up .col { width: 71px !important; } .block-grid.eight-up .col { width: 62px !important; } .block-grid.nine-up .col { width: 55px !important; } .block-grid.ten-up .col { width: 50px !important; } .block-grid.eleven-up .col { width: 45px !important; } .block-grid.twelve-up .col { width: 41px !important; } } @media (max-width: 520px) { .block-grid, .col { min-width: 320px !important; max-width: 100% !important; display: block !important; } .block-grid { width: calc(100% - 40px) !important; } .col { width: 100% !important; } .col > div { margin: 0 auto; } img.fullwidth, img.fullwidthOnMobile { max-width: 100% !important; } .no-stack .col { min-width: 0 !important; display: table-cell !important; } .no-stack.two-up .col { width: 50% !important; } .no-stack.mixed-two-up .col.num4 { width: 33% !important; } .no-stack.mixed-two-up .col.num8 { width: 66% !important; } .no-stack.three-up .col.num4 { width: 33% !important; } .no-stack.four-up .col.num3 { width: 25% !important; } } </style> </head> <body class=\"clean-body\" style=\"margin: 0;padding: 0;-webkit-text-size-adjust: 100%;background-color: #f6f7fb;\"> <table class=\"nl-container\" style=\"border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;min-width: 320px;Margin: 0 auto;background-color: #ffffff;\" cellpadding=\"0\" cellspacing=\"0\"> <tbody>  <tr style=\"vertical-align: top\">     <td style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">        <!-- logo section   -->        <div style=\"background-color:transparent;\">           <div style=\"Margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\" class=\"block-grid \">              <div style=\"border-collapse: collapse;display: table;width: 100%;background-color:transparent;\">                 <div class=\"col num12\" style=\"min-width: 320px;max-width: 500px;display: table-cell;vertical-align: top;background:#f6f7fb;\">                    <div style=\"background-color: transparent; width: 100% !important;\">                       <div style=\"border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;\">                          <div class=\"img-container center  autowidth \" style=\"text-align:center;padding:15px;\">                             <img class=\"center  autowidth \" align=\"center\" border=\"0\" src=\"" + LogoImageUrl + "\" alt=\"Image\" title=\"Image\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: 0;height: auto;float: none;width: 100%;max-width: 161px;margin:0 auto;\" width=\"161\">                          </div>                       </div>                    </div>                 </div>              </div>           </div>        </div>        <!-- logo section end  -->  <!-- content section -->        <div style=\"background-color:transparent;border-top: 5px solid #5a00af;border-bottom: 10px solid #f5f5f5;\">           <div style=\"background-color:transparent;\">              <div style=\"Margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\" class=\"block-grid \">                 <div style=\"border-collapse: collapse;display: table;width: 100%;background-color:transparent;\">                    <div class=\"col num12\" style=\"min-width: 320px;max-width: 500px;display: table-cell;vertical-align: top;\">                       <div style=\"background-color: transparent; width: 100% !important;\">                          <div style=\"padding:0 10px;border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-top:20px; padding-bottom:30px; padding-right: 0px; padding-left: 0px;\">                             <div style=\" padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;\">                                <div style=\"font-size:12px;padding:0 25px;text-align:left;\">                                   <p style=\"margin: 0;font-size: 12px;color:#000;\"><span class=\"font-semi-bold\" style=\"font-size: 16px;\">" + invitedBy + " invited you to join plug-able</span>                                   <p style=\"font-size:14px;padding:10px 0;\">Lorem Ipsum is simply dummy text of the printing and typesetting industry. </p>                                   <div style=\"text-align:center;\">                                      <a href=\"" + InvitationLink + "\" style=\"margin:20px 0;background:#5a00af;color:#fff;                                         font-size:14px;border:0;border-radius:4px;min-width:120px;padding:10px 15px;text-decoration:none;display:inline-block;\">Accept Invitation</a>                                   </div>                                                                                                         <p style=\"font-size:14px;margin-top:30px;\">Thank you,</p>                                   <p style=\"font-size:14px;\">Plug-able team</p>                                   </p>                                </div>                             </div>                          </div>                       </div>                    </div>                 </div>              </div>           </div>        </div>        <!-- content section end-->  <!-- footer content section -->        <div style=\"background-color:transparent;\">           <div style=\"Margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\" class=\"block-grid \">              <div style=\"border-collapse: collapse;display: table;width: 100%;background-color:transparent;\">                 <div class=\"col num12\" style=\"min-width: 320px;max-width: 500px;display: table-cell;vertical-align: top;background:#262f36;\">                    <div style=\"background-color: transparent; width: 100% !important;\">                       <div style=\"border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;\">                          <div style=\"padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;\">                             <div style=\"font-size:12px;text-align:center;\">                             </div>                             <div style=\"font-size:12px;text-align:center;color:#fff;\">                                <p style=\"margin: 0;font-size: 12px;text-align: center\"><span style=\"font-size: 14px;font-weight:300;\">\u00A9 2018, plug-able.com</span></p>                             </div>                          </div>                       </div>                    </div>                 </div>              </div>           </div>        </div>        <!-- footer content section -->             </td>  </tr> </tbody> </table> </body> </html>";
        }

        public string SubscriptionTemplateBody(string PackageName = "Pacakge 1", string Amount = "40")
        {
            string LogoImageUrl = "http://114.143.198.154:8386/images/asset/logo.png";
            return "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional //EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"> <html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\"> <head> <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"> <meta name=\"viewport\" content=\"width=device-width\"> <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"> <link href=\"https://fonts.googleapis.com/css?family=Poppins:100,200,300,400,500,600,700,800\" rel=\"stylesheet\"> <title></title> <style type=\"text/css\" id=\"media-query\"> *{ margin:0; padding:0; } body { margin: 0; padding: 0;  background: #f6f7fb !important; font-family: 'Poppins', sans-serif; font-weight: 500; line-height: 1.6; color:#2f2f2f; } .font-semi-bold{     font-weight: 600; } table, tr, td { vertical-align: top; border-collapse: collapse; } .ie-browser table, .mso-container table { table-layout: fixed; } * { line-height: inherit; } a[x-apple-data-detectors=true] { color: inherit !important; text-decoration: none !important; } [owa] .img-container div, [owa] .img-container button { display: block !important; } [owa] .fullwidth button { width: 100% !important; } [owa] .block-grid .col { display: table-cell; float: none !important; vertical-align: top; } .ie-browser .num12, .ie-browser .block-grid, [owa] .num12, [owa] .block-grid { width: 500px !important; } .ExternalClass, .ExternalClass p, .ExternalClass span, .ExternalClass font, .ExternalClass td, .ExternalClass div { line-height: 100%; } .ie-browser .mixed-two-up .num4, [owa] .mixed-two-up .num4 { width: 164px !important; } .ie-browser .mixed-two-up .num8, [owa] .mixed-two-up .num8 { width: 328px !important; } .ie-browser .block-grid.two-up .col, [owa] .block-grid.two-up .col { width: 250px !important; } .ie-browser .block-grid.three-up .col, [owa] .block-grid.three-up .col { width: 166px !important; } .ie-browser .block-grid.four-up .col, [owa] .block-grid.four-up .col { width: 125px !important; } .ie-browser .block-grid.five-up .col, [owa] .block-grid.five-up .col { width: 100px !important; } .ie-browser .block-grid.six-up .col, [owa] .block-grid.six-up .col { width: 83px !important; } .ie-browser .block-grid.seven-up .col, [owa] .block-grid.seven-up .col { width: 71px !important; } .ie-browser .block-grid.eight-up .col, [owa] .block-grid.eight-up .col { width: 62px !important; } .ie-browser .block-grid.nine-up .col, [owa] .block-grid.nine-up .col { width: 55px !important; } .ie-browser .block-grid.ten-up .col, [owa] .block-grid.ten-up .col { width: 50px !important; } .ie-browser .block-grid.eleven-up .col, [owa] .block-grid.eleven-up .col { width: 45px !important; } .ie-browser .block-grid.twelve-up .col, [owa] .block-grid.twelve-up .col { width: 41px !important; } @media only screen and (min-width: 520px) { .block-grid { width: 500px !important; } .block-grid .col { vertical-align: top; } .block-grid .col.num12 { width: 500px !important; } .block-grid.mixed-two-up .col.num4 { width: 164px !important; } .block-grid.mixed-two-up .col.num8 { width: 328px !important; } .block-grid.two-up .col { width: 250px !important; } .block-grid.three-up .col { width: 166px !important; } .block-grid.four-up .col { width: 125px !important; } .block-grid.five-up .col { width: 100px !important; } .block-grid.six-up .col { width: 83px !important; } .block-grid.seven-up .col { width: 71px !important; } .block-grid.eight-up .col { width: 62px !important; } .block-grid.nine-up .col { width: 55px !important; } .block-grid.ten-up .col { width: 50px !important; } .block-grid.eleven-up .col { width: 45px !important; } .block-grid.twelve-up .col { width: 41px !important; } } @media (max-width: 520px) { .block-grid, .col { min-width: 320px !important; max-width: 100% !important; display: block !important; } .block-grid { width: calc(100% - 40px) !important; } .col { width: 100% !important; } .col > div { margin: 0 auto; } img.fullwidth, img.fullwidthOnMobile { max-width: 100% !important; } .no-stack .col { min-width: 0 !important; display: table-cell !important; } .no-stack.two-up .col { width: 50% !important; } .no-stack.mixed-two-up .col.num4 { width: 33% !important; } .no-stack.mixed-two-up .col.num8 { width: 66% !important; } .no-stack.three-up .col.num4 { width: 33% !important; } .no-stack.four-up .col.num3 { width: 25% !important; } } </style> </head> <body class=\"clean-body\" style=\"margin: 0;padding: 0;-webkit-text-size-adjust: 100%;background-color: #f6f7fb;\"> <table class=\"nl-container\" style=\"border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;min-width: 320px;Margin: 0 auto;background-color: #ffffff;\" cellpadding=\"0\" cellspacing=\"0\"> <tbody>  <tr style=\"vertical-align: top\">     <td style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">               <!-- logo section   -->        <div style=\"background-color:transparent;\">           <div style=\"Margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\" class=\"block-grid \">              <div style=\"border-collapse: collapse;display: table;width: 100%;background-color:transparent;\">                 <div class=\"col num12\" style=\"min-width: 320px;max-width: 500px;display: table-cell;vertical-align: top;background:#f6f7fb;\">                    <div style=\"background-color: transparent; width: 100% !important;\">                       <div style=\"border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;\">                          <div class=\"img-container center  autowidth \" style=\"text-align:center;padding:15px;\">                             <img class=\"center  autowidth \" align=\"center\" border=\"0\" src=\"" + LogoImageUrl + "\" alt=\"Image\" title=\"Image\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: 0;height: auto;float: none;width: 100%;max-width: 161px;margin:0 auto;\" width=\"161\">                          </div>                       </div>                    </div>                 </div>              </div>           </div>        </div>        <!-- logo section end  -->  <!-- content section -->        <div style=\"background-color:transparent;border-top: 5px solid #5a00af;border-bottom: 10px solid #f5f5f5;\">           <div style=\"background-color:transparent;\">              <div style=\"Margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\" class=\"block-grid \">                 <div style=\"border-collapse: collapse;display: table;width: 100%;background-color:transparent;\">                    <div class=\"col num12\" style=\"min-width: 320px;max-width: 500px;display: table-cell;vertical-align: top;\">                       <div style=\"background-color: transparent; width: 100% !important;\">                          <div style=\"padding:0 10px;border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-top:20px; padding-bottom:30px; padding-right: 0px; padding-left: 0px;\">                             <div style=\" padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;\">                                <div style=\"font-size:12px;padding:0 25px;text-align:left;\">                                   <p style=\"margin: 0;font-size: 12px;color:#000;\"><span class=\"font-semi-bold\" style=\"font-size: 16px;\">Thank you for your payment.</span>                                   <p style=\"font-size:14px;padding:10px 0;\">You have purchased <span class=\"font-semi-bold\">\"" + PackageName + "\".</span> We have successfully received your payment of $ " + Amount + ".</p>                                                                      <p style=\"font-size:14px;padding-bottom:15px;margin-top:20px;\">If you have any further questions  please feel free to contact our <a href=\"#\" style=\"color:#5a00af;text-decoration: none;\">support team.</a></p>                                                                      <p style=\"font-size:14px;margin-top:30px;\">Thank you,</p>                                   <p style=\"font-size:14px;\">Plug-able team</p>                                   </p>                                </div>                             </div>                          </div>                       </div>                    </div>                 </div>              </div>           </div>        </div>        <!-- content section end-->  <!-- footer content section -->        <div style=\"background-color:transparent;\">           <div style=\"Margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\" class=\"block-grid \">              <div style=\"border-collapse: collapse;display: table;width: 100%;background-color:transparent;\">                 <div class=\"col num12\" style=\"min-width: 320px;max-width: 500px;display: table-cell;vertical-align: top;background:#262f36;\">                    <div style=\"background-color: transparent; width: 100% !important;\">                       <div style=\"border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;\">                          <div style=\"padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;\">                             <div style=\"font-size:12px;text-align:center;\">                             </div>                             <div style=\"font-size:12px;text-align:center;color:#fff;\">                                <p style=\"margin: 0;font-size: 12px;text-align: center\"><span style=\"font-size: 14px;font-weight:300;\">\u00A9 2018, plug-able.com</span></p>                             </div>                          </div>                       </div>                    </div>                 </div>              </div>           </div>        </div>        <!-- footer content section -->             </td>  </tr> </tbody> </table> </body> </html>";
        }

        public string VerifyEmailTemplateBody(string EmailVerificationLink = "#")
        {
            string LogoImageUrl = "http://114.143.198.154:8386/images/asset/logo.png";

            return "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional //EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"> <html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\"> <head> <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"> <meta name=\"viewport\" content=\"width=device-width\"> <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"> <link href=\"https://fonts.googleapis.com/css?family=Poppins:100,200,300,400,500,600,700,800\" rel=\"stylesheet\"> <title></title> <style type=\"text/css\" id=\"media-query\"> *{ margin:0; padding:0; } body { margin: 0; padding: 0;  background: #f6f7fb !important; font-family: 'Poppins', sans-serif; font-weight: 500; line-height: 1.6; color:#2f2f2f; } .font-semi-bold{     font-weight: 600; } table, tr, td { vertical-align: top; border-collapse: collapse; } .ie-browser table, .mso-container table { table-layout: fixed; } * { line-height: inherit; } a[x-apple-data-detectors=true] { color: inherit !important; text-decoration: none !important; } [owa] .img-container div, [owa] .img-container button { display: block !important; } [owa] .fullwidth button { width: 100% !important; } [owa] .block-grid .col { display: table-cell; float: none !important; vertical-align: top; } .ie-browser .num12, .ie-browser .block-grid, [owa] .num12, [owa] .block-grid { width: 500px !important; } .ExternalClass, .ExternalClass p, .ExternalClass span, .ExternalClass font, .ExternalClass td, .ExternalClass div { line-height: 100%; } .ie-browser .mixed-two-up .num4, [owa] .mixed-two-up .num4 { width: 164px !important; } .ie-browser .mixed-two-up .num8, [owa] .mixed-two-up .num8 { width: 328px !important; } .ie-browser .block-grid.two-up .col, [owa] .block-grid.two-up .col { width: 250px !important; } .ie-browser .block-grid.three-up .col, [owa] .block-grid.three-up .col { width: 166px !important; } .ie-browser .block-grid.four-up .col, [owa] .block-grid.four-up .col { width: 125px !important; } .ie-browser .block-grid.five-up .col, [owa] .block-grid.five-up .col { width: 100px !important; } .ie-browser .block-grid.six-up .col, [owa] .block-grid.six-up .col { width: 83px !important; } .ie-browser .block-grid.seven-up .col, [owa] .block-grid.seven-up .col { width: 71px !important; } .ie-browser .block-grid.eight-up .col, [owa] .block-grid.eight-up .col { width: 62px !important; } .ie-browser .block-grid.nine-up .col, [owa] .block-grid.nine-up .col { width: 55px !important; } .ie-browser .block-grid.ten-up .col, [owa] .block-grid.ten-up .col { width: 50px !important; } .ie-browser .block-grid.eleven-up .col, [owa] .block-grid.eleven-up .col { width: 45px !important; } .ie-browser .block-grid.twelve-up .col, [owa] .block-grid.twelve-up .col { width: 41px !important; } @media only screen and (min-width: 520px) { .block-grid { width: 500px !important; } .block-grid .col { vertical-align: top; } .block-grid .col.num12 { width: 500px !important; } .block-grid.mixed-two-up .col.num4 { width: 164px !important; } .block-grid.mixed-two-up .col.num8 { width: 328px !important; } .block-grid.two-up .col { width: 250px !important; } .block-grid.three-up .col { width: 166px !important; } .block-grid.four-up .col { width: 125px !important; } .block-grid.five-up .col { width: 100px !important; } .block-grid.six-up .col { width: 83px !important; } .block-grid.seven-up .col { width: 71px !important; } .block-grid.eight-up .col { width: 62px !important; } .block-grid.nine-up .col { width: 55px !important; } .block-grid.ten-up .col { width: 50px !important; } .block-grid.eleven-up .col { width: 45px !important; } .block-grid.twelve-up .col { width: 41px !important; } } @media (max-width: 520px) { .block-grid, .col { min-width: 320px !important; max-width: 100% !important; display: block !important; } .block-grid { width: calc(100% - 40px) !important; } .col { width: 100% !important; } .col > div { margin: 0 auto; } img.fullwidth, img.fullwidthOnMobile { max-width: 100% !important; } .no-stack .col { min-width: 0 !important; display: table-cell !important; } .no-stack.two-up .col { width: 50% !important; } .no-stack.mixed-two-up .col.num4 { width: 33% !important; } .no-stack.mixed-two-up .col.num8 { width: 66% !important; } .no-stack.three-up .col.num4 { width: 33% !important; } .no-stack.four-up .col.num3 { width: 25% !important; } } </style> </head> <body class=\"clean-body\" style=\"margin: 0;padding: 0;-webkit-text-size-adjust: 100%;background-color: #f6f7fb;\"> <table class=\"nl-container\" style=\"border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;min-width: 320px;Margin: 0 auto;background-color: #ffffff;\" cellpadding=\"0\" cellspacing=\"0\"> <tbody>  <tr style=\"vertical-align: top\">     <td style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">               <!-- logo section   -->        <div style=\"background-color:transparent;\">           <div style=\"Margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\" class=\"block-grid \">              <div style=\"border-collapse: collapse;display: table;width: 100%;background-color:transparent;\">                 <div class=\"col num12\" style=\"min-width: 320px;max-width: 500px;display: table-cell;vertical-align: top;background:#f6f7fb;\">                    <div style=\"background-color: transparent; width: 100% !important;\">                       <div style=\"border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;\">                          <div class=\"img-container center  autowidth \" style=\"text-align:center;padding:15px;\">                             <img class=\"center  autowidth \" align=\"center\" border=\"0\" src=\"" + LogoImageUrl + "\" alt=\"Image\" title=\"Image\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: 0;height: auto;float: none;width: 100%;max-width: 161px;margin:0 auto;\" width=\"161\">                          </div>                       </div>                    </div>                 </div>              </div>           </div>        </div>        <!-- logo section end  -->  <!-- content section -->        <div style=\"background-color:transparent;border-top: 5px solid #5a00af;border-bottom: 10px solid #f5f5f5;\">           <div style=\"background-color:transparent;\">              <div style=\"Margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\" class=\"block-grid \">                 <div style=\"border-collapse: collapse;display: table;width: 100%;background-color:transparent;\">                    <div class=\"col num12\" style=\"min-width: 320px;max-width: 500px;display: table-cell;vertical-align: top;\">                       <div style=\"background-color: transparent; width: 100% !important;\">                          <div style=\"padding:0 10px;border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-top:20px; padding-bottom:30px; padding-right: 0px; padding-left: 0px;\">                             <div style=\" padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;\">                                <div style=\"font-size:12px;padding:0 25px;text-align:left;\">                                   <p style=\"margin: 0;font-size: 12px;color:#000;\"><span class=\"font-semi-bold\" style=\"font-size: 16px;\">Thanks for joining plug-able</span>                                   <p style=\"font-size:14px;padding:10px 0;\">To complete your plug-able profile we need you to confirm your email address so we know that you're reachable at this address.</p> <div style=\"text-align:center;\">                                      <a href=\"" + EmailVerificationLink + "\" style=\"margin:20px 0;background:#5a00af;color:#fff; font-size:14px;border:0;border-radius:4px;min-width:120px;padding:10px 15px;text-decoration:none;display:inline-block;\">Confirm my email address</a>                                   </div>                                   <p style=\"font-size:14px;padding-bottom:15px;margin-top:20px;\">Please note that this link will expire in 2 days.</p>                                   <p style=\"font-size:14px;margin-top:5px;\">If you have not signed up to plug-able, please ignore this email.</p>                                   <p style=\"font-size:14px;margin-top:30px;\">All the best,</p>                                   <p style=\"font-size:14px;\">Plug-able team</p>                                   </p>                                </div>                             </div>                          </div>                       </div>                    </div>                 </div>              </div>           </div>        </div>        <!-- content section end-->  <!-- footer content section -->        <div style=\"background-color:transparent;\">           <div style=\"Margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\" class=\"block-grid \">              <div style=\"border-collapse: collapse;display: table;width: 100%;background-color:transparent;\">                 <div class=\"col num12\" style=\"min-width: 320px;max-width: 500px;display: table-cell;vertical-align: top;background:#262f36;\">                    <div style=\"background-color: transparent; width: 100% !important;\">                       <div style=\"border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;\">                          <div style=\"padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;\">                             <div style=\"font-size:12px;text-align:center;\">                             </div>                             <div style=\"font-size:12px;text-align:center;color:#fff;\">                                <p style=\"margin: 0;font-size: 12px;text-align: center\"><span style=\"font-size: 14px;font-weight:300;\">\u00A9 2018, plug-able.com</span></p>                             </div>                          </div>                       </div>                    </div>                 </div>              </div>           </div>        </div>        <!-- footer content section -->             </td>  </tr> </tbody> </table> </body> </html>";
        }

        public string OrderReciptTemplateBody(MailReciptViewModel model)
        {

            var body = "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional //EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\"> <head>  <!--[if gte mso 9]>  <xml> <o:OfficeDocumentSettings>  <o:AllowPNG/>  <o:PixelsPerInch>96</o:PixelsPerInch> </o:OfficeDocumentSettings>  </xml>  <![endif]-->  <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">  <meta name=\"viewport\" content=\"width=device-width\">  <!--[if !mso]><!-->  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">  <!--<![endif]-->  <link href=\"https://fonts.googleapis.com/css?family=Poppins:100,200,300,400,500,600,700,800\" rel=\"stylesheet\">  <title></title>  <style type=\"text/css\" id=\"media-query\"> *{ margin:0; padding:0; } body { margin: 0; padding: 0;  background: #f5f5f5 !important; font-family: 'Poppins', sans-serif; font-weight: 400; line-height: 1.6; color:#6f6f71; } table, tr, td { vertical-align: top; border-collapse: collapse; } .ie-browser table, .mso-container table { table-layout: fixed; } * { line-height: inherit; } a[x-apple-data-detectors=true] { color: inherit !important; text-decoration: none !important; } [owa] .img-container div, [owa] .img-container button { display: block !important; } [owa] .fullwidth button { width: 100% !important; } [owa] .block-grid .col { display: table-cell; float: none !important; vertical-align: top; } .ie-browser .num12, .ie-browser .block-grid, [owa] .num12, [owa] .block-grid { width: 500px !important; } .ExternalClass, .ExternalClass p, .ExternalClass span, .ExternalClass font, .ExternalClass td, .ExternalClass div { line-height: 100%; } .ie-browser .mixed-two-up .num4, [owa] .mixed-two-up .num4 { width: 164px !important; } .ie-browser .mixed-two-up .num8, [owa] .mixed-two-up .num8 { width: 328px !important; } .ie-browser .block-grid.two-up .col, [owa] .block-grid.two-up .col { width: 250px !important; } .ie-browser .block-grid.three-up .col, [owa] .block-grid.three-up .col { width: 166px !important; } .ie-browser .block-grid.four-up .col, [owa] .block-grid.four-up .col { width: 125px !important; } .ie-browser .block-grid.five-up .col, [owa] .block-grid.five-up .col { width: 100px !important; } .ie-browser .block-grid.six-up .col, [owa] .block-grid.six-up .col { width: 83px !important; } .ie-browser .block-grid.seven-up .col, [owa] .block-grid.seven-up .col { width: 71px !important; } .ie-browser .block-grid.eight-up .col, [owa] .block-grid.eight-up .col { width: 62px !important; } .ie-browser .block-grid.nine-up .col, [owa] .block-grid.nine-up .col { width: 55px !important; } .ie-browser .block-grid.ten-up .col, [owa] .block-grid.ten-up .col { width: 50px !important; } .ie-browser .block-grid.eleven-up .col, [owa] .block-grid.eleven-up .col { width: 45px !important; } .ie-browser .block-grid.twelve-up .col, [owa] .block-grid.twelve-up .col { width: 41px !important; } @media only screen and (min-width: 520px) { .block-grid { width: 500px !important; } .block-grid .col { vertical-align: top; } .block-grid .col.num12 { width: 500px !important; } .block-grid.mixed-two-up .col.num4 { width: 164px !important; } .block-grid.mixed-two-up .col.num8 { width: 328px !important; } .block-grid.two-up .col { width: 250px !important; } .block-grid.three-up .col { width: 166px !important; } .block-grid.four-up .col { width: 125px !important; } .block-grid.five-up .col { width: 100px !important; } .block-grid.six-up .col { width: 83px !important; } .block-grid.seven-up .col { width: 71px !important; } .block-grid.eight-up .col { width: 62px !important; } .block-grid.nine-up .col { width: 55px !important; } .block-grid.ten-up .col { width: 50px !important; } .block-grid.eleven-up .col { width: 45px !important; } .block-grid.twelve-up .col { width: 41px !important; } } @media (max-width: 520px) { .block-grid, .col { min-width: 320px !important; max-width: 100% !important; display: block !important; } .block-grid { width: calc(100% - 40px) !important; } .col { width: 100% !important; } .col > div { margin: 0 auto; } img.fullwidth, img.fullwidthOnMobile { max-width: 100% !important; } .no-stack .col { min-width: 0 !important; display: table-cell !important; } .no-stack.two-up .col { width: 50% !important; } .no-stack.mixed-two-up .col.num4 { width: 33% !important; } .no-stack.mixed-two-up .col.num8 { width: 66% !important; } .no-stack.three-up .col.num4 { width: 33% !important; } .no-stack.four-up .col.num3 { width: 25% !important; } }  </style> </head> <body class=\"clean-body\" style=\"margin: 0;padding: 0;-webkit-text-size-adjust: 100%;background-color: #ffffff\">  <style type=\"text/css\" id=\"media-query-bodytag\"> @media (max-width: 520px) { .block-grid { min-width: 320px!important; max-width: 100%!important; width: 100%!important; display: block!important; } .col { min-width: 320px!important; max-width: 100%!important; width: 100%!important; display: block!important; } .col > div { margin: 0 auto; } img.fullwidth { max-width: 100%!important; } img.fullwidthOnMobile { max-width: 100%!important; } .no-stack .col { min-width: 0!important; display: table-cell!important; } .no-stack.two-up .col { width: 50%!important; } .no-stack.mixed-two-up .col.num4 { width: 33%!important; } .no-stack.mixed-two-up .col.num8 { width: 66%!important; } .no-stack.three-up .col.num4 { width: 33%!important } .no-stack.four-up .col.num3 { width: 25%!important } }  </style>  <table class=\"nl-container\" style=\"border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;min-width: 320px;Margin: 0 auto;background-color: #ffffff;\" cellpadding=\"0\" cellspacing=\"0\"> <tbody>  <tr style=\"vertical-align: top\"> <td style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">  <div style=\"background-color:transparent;\"> <div style=\"Margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\" class=\"block-grid \">  <div style=\"border-collapse: collapse;display: table;width: 100%;background-color:transparent;\"> <div class=\"col num12\" style=\"min-width: 320px;max-width: 500px;display: table-cell;vertical-align: top;\">  <div style=\"width: 100% !important;\"> <div style=\"border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-right: 0px; padding-left: 0px;\">  <div align=\"center\" class=\"img-container center  autowidth \" style=\"text-align:center;padding:10px 15px;\"> " +
                " <img src=\"http://165.22.60.17:9003/images/app_logo.png\" width=\"40%\" alt=\"logo\">" +
            " </div> </div>  </div> </div>  </div> </div>  </div>  <div style=\"background-color:transparent;\"> <div style=\"background-color:transparent;\">  <div style=\"Margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\" class=\"block-grid \"> <div style=\"border-collapse: collapse;display: table;width: 100%;background-color:transparent;\">  <div class=\"col num12\" style=\"min-width: 320px;max-width: 500px;display: table-cell;vertical-align: top;\"> <div style=\"background-color: transparent; width: 100% !important;\">  <div style=\"padding:0 10px;border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;\"> <div style=\"padding-top: 10px; padding-bottom: 10px;color:#000;\">  <div style=\"font-size:12px;padding:0 40px 10px 40px;text-align:left;\">  <span style=\"font-size:14px;font-weight:500;\">" +
            "Order No :" + model.OrderNumber + "</span> <br>  <span style=\"font-size:14px;font-weight:500;\">" +
                model.OrderDateTime + "</span>  <div style=\"clear:both;\"></div> </p>  </div>  <hr style=\"background: #ffb246;border-top: 1px solid #ffb246 !important;border:0;\">    <hr style=\"background: #ffb246;border-top: 1px solid #ffb246 !important;border:0;\">  <div style=\"padding:15px 40px 10px 40px;\"> <span style=\"font-weight:500;font-size:14px;display:inline-block;border-bottom: 2px solid #ffb246\">Order Details</span> <div style=\"border-radius:4px;margin-top:15px;\">   <table style=\"width: 100%;\"> ";
            body = body + "<tr style=\"border-bottom:1px solid #ffb246;\"> <td style=\"width: 5 %;\">&nbsp;</td>  <td style=\"width: 55%;\">Products</td>  <td style=\"width: 20%;text-align:center;\">Quantity</td>  <td style=\"width: 25%;text-align:center;\">Price(Rs.)</td> </tr>\r\n";
            foreach (var product in model.ProductList)
            {
                body = body + "<tr><td><ul><li></li></ul></td>  <td style=\"width: 55%;\">" + product.Product + "</td>  <td style=\"width: 20%;text-align:center;\">" + product.Quantity + "</td>  <td style=\"width: 25%;text-align:center;\">" + product.Price + "</td> </tr>\r\n";
            }
            body = body + "</table> </div> </div>  <hr style=\"background:#ffb246;border-top:1px solid #ffb246 !important;border:0;margin-top:10px;\">  <div style=\"padding:15px 40px 10px 40px;\"> <span style=\"font-weight:500;font-size:14px;display:inline-block;border-bottom: 2px solid #ffb246\">Total Amount</span> <div style=\"border-radius:4px;margin-top:15px;\">  <table style=\"width: 100%; border-bottom: 1px solid #ffb246 ;\"> " +
                " <tr> <td style=\"width: 60%;\">Sub Total</td><td style=\"width: 5%; text-align: right;\">Rs.</td> <td style=\"width: 20%; text-align:center;\">" + model.FinalAmountDetails.SubTotal + "</td>  </tr>";
            if (model.FinalAmountDetails.ProductDiscount != "0")
            {
                body = body + "<tr><td>Product Discount</td><td style=\"text-align: right;\">Rs.</td><td style=\"text-align:center;\">" + model.FinalAmountDetails.ProductDiscount + "</td></tr>";
            }
            body = body + "<tr> <td>Delivery Charges</td><td style=\"text-align: right;\"> ";
            if (model.FinalAmountDetails.DeliveryCharges.ToLower() != "free") { body = body + "Rs. "; }
            body = body + "</td> <td style=\"text-align:center;\">" + model.FinalAmountDetails.DeliveryCharges + "</td>  </tr> " +
               "</table> <table style=\"width: 100%; border-bottom: 0px solid #ffb246 ;\"> <tr> " +
               " <td style=\"width: 60%;\">Total Price</td> <td style=\"width: 5%; text-align: right;\"> <b>Rs.</b></td> <td style=\"width: 20%;text-align:center;\"><b>" + model.FinalAmountDetails.TotalPrice + " /- </b></td> </tr> </table> </div> </div>  <hr style=\"background:#ffb246;border-top:1px solid #ffb246 !important;border:0;margin-top:10px;\">\r\n <div style=\"padding:15px 40px 10px 40px;\"> <span style=\"font-weight:500;font-size:14px;display:inline-block;border-bottom: 2px solid #ffb246\">Customer Details</span> <div>  <ul style=\"list-style:none;font-size:14px;margin-top:15px;\"> <li><span style=\"display:inline-block;width:90px;vertical-align:top;\">Name:</span><span style=\"width:calc(100% - 90px);display:inline-block;verticala-align:top;\"> <b>" +
                model.CustomerDetails.Name + "</b> </span></li> <li><span style=\"display:inline-block;width:90px;vertical-align:top;\">Email:</span><span style=\"width:calc(100% - 90px);display:inline-block;verticala-align:top;\">" +
                model.CustomerDetails.Email + "</span></li> <li><span style=\"display:inline-block;width:90px;vertical-align:top;\">Mobile No:</span><span style=\"width:calc(100% - 90px);display:inline-block;verticala-align:top;\"> <b>" +
                model.CustomerDetails.MobileNo + "</b> </span</li> <li><span style=\"display:inline-block;width:90px;vertical-align:top;\">Address:</span><span style=\"width:calc(100% - 90px);display:inline-block;verticala-align:top;\">" +
                model.CustomerDetails.Address.Address + " <br />" +
                model.CustomerDetails.Address.Landmark + " <br />" +
                model.CustomerDetails.Address.AreaPincode + " <br />" +
                model.CustomerDetails.Address.PhoneNumber +
                "</span</li> </ul> </div>  </div> ";
            if (!string.IsNullOrEmpty(model.CustomerComment))
            {
                body += "<div style=\"padding:15px 40px 10px 40px;\"> <span style=\"font-weight:500;font-size:14px;display:inline-block;border-bottom: 2px solid #ffb246\">Customer Comments</span><div>" +
                   model.CustomerComment + "</div></div>";
            }
            body += "</div>  </div> </div>  </div> </div>  </div> </div>" +
            "</div><div style=\"font-size:12px;text-align:center;\"><a href=\"https://play.google.com/store/apps/details?id=com.plugable.mcommerceapp.mvp1\"><img width=\"20%\" alt=\"playstore\" src=\"https://www.gstatic.com/android/market_images/web/play_prism_hlock_2x.png\"></a></div>" +
            "<div style=\"background-color:transparent;\"> <div style=\"Margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\" class=\"block-grid \">  <div style=\"border-collapse: collapse;display: table;width: 100%;background-color:transparent;\"> <div class=\"col num12\" style=\"min-width: 320px;max-width: 500px;display: table-cell;vertical-align: top;background:#6cbe96;\">  <div style=\"background-color: transparent; width: 100% !important;\"> <div style=\"border-top: 0px solid transparent; border-left: 0px solid transparent; border-bottom: 0px solid transparent; border-right: 0px solid transparent; padding-top:5px; padding-bottom:5px; padding-right: 0px; padding-left: 0px;\">  <div style=\"padding-right: 10px; padding-left: 10px; padding-top: 10px; padding-bottom: 10px;\"> <div style=\"font-size:12px;text-align:center;\"> </div> <div style=\"font-size:12px;text-align:center;color:#fff;\">  <p style=\"margin: 0;font-size: 12px;text-align: center\"><span style=\"font-size: 13px;font-weight:300;\">&copy; Copyright 2019</span></p> </div>  </div> </div>  </div> </div>  </div> </div>  </div> </td>  </tr> </tbody>  </table> </body>\r\n</html>";
            return body;
        }
    }
}
